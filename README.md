# morland-cipher

Breaking Sir Samuel Morland's New Method of Cryptography

This project is inspired by the National Archives blog post "[Hidden in plain sight: an undeciphered letter from Louis XIV’s France](https://www.nationalarchives.gov.uk/explore-the-collection/the-collection-blog/undeciphered-letter-from-louis-xivs-france/)". The post highlights an enciphered message from 1670 that William Perwich, an English diplomat, sent to Lord Arlington, a close advisor to Charles II.

The method of encryption is not known, but it could be one of the methods published by Sir Samuel Morland in his paper "[A New Method of Cryptography](https://archive.org/details/bim_early-english-books-1641-1700_a-new-method-of-cryptogr_morland-sir-samuel_1666)", a few years earlier in 1666.

While Morland also presents methods that utilise non-rectangular patterns, he focuses on methods that are based on columnar transposition of a rectangular grid.

To illustrate the difficulty of deciphering the message without the key, Morland correctly states that encrypting a message of 81 characters on a 3x27 grid results in 27! (more than ten octillion) possible keys.

However, by using techniques developed since 1666, we can break Morland's method and possibly decrypt Perwich's message.

## Installation

Clone the repository and install its dependencies:

```bash
git clone https://github.com/joehowells/morland-cipher.git
cd morland-cipher
pip install -r requirements.txt
```

Note: This project was developed in Python 3.13. Older versions may work but have not been checked.

## Usage

Run the main script from the shell to decrypt the provided ciphertext using the provided word list:

```bash
python main.py WORD-LIST CIPHERTEXT
```

- `WORD-LIST`: Path to a word-frequency list (e.g., `data/word-list/eng-gb.txt`).
- `CIPHERTEXT`: Path to a ciphertext file (e.g., `data/ciphertext/morland-page01.txt`). Tokens in the ciphertext file should be separated by spaces to detect multi-character tokens. Line breaks are treated as spaces but otherwise do not matter.

## Example

```bash
python main.py data/word-list/eng-gb.txt data/ciphertext/morland-page01.txt
```

## Method

TODO: Expand bullet points to complete section

- Summarise Morland's method
- Example grid
- Quantify how likely columns are to follow one another based on log-OE
- Build digraph of columns (nodes) and column pairs (edges)
- Find path that maximises log-OE using TSP solver
- Repeat for all possible combinations of column and null count

## Bibliography

- Furnon, Vincent, and Laurent Perron. *OR-Tools Routing Library*. Version 9.14. Google, June 19, 2025. <https://developers.google.com/optimization/routing/>.
- Michel, Jean‑Baptiste, Yuan Kui Shen, Aviva Presser Aiden, et al. "Quantitative Analysis of Culture Using Millions of Digitized Books." *Science* 331, no. 6014 (2011): 176–82. <https://doi.org/10.1126/science.1199644>.
- Morland, Sir Samuel. *A New Method of Cryptography*. 1666. Early English Books, 1641–1700. Internet Archive. Accessed September 21, 2025. <https://archive.org/details/bim_early-english-books-1641-1700_a-new-method-of-cryptogr_morland-sir-samuel_1666/>.
- Selman, Ruth. "Hidden in Plain Sight: An Undeciphered Letter from Louis XIV’s France." *The Collection Blog*. August 4, 2025. Accessed September 21, 2025. <https://www.nationalarchives.gov.uk/explore-the-collection/the-collection-blog/undeciphered-letter-from-louis-xivs-france/>.

## License

The code in this repository is licensed under the MIT license (see `LICENSE`).

The data files are licensed under [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/).

The word-frequency lists in the `data/word-list` directory are derived from Version 3 of the [Google Books Ngram Viewer Dataset](https://storage.googleapis.com/books/ngrams/books/datasetsv3.html). The source data is licensed under [CC BY 3.0](https://creativecommons.org/licenses/by/3.0/). These lists were generated by running `word_list.py` on the dataset's 1‑gram files.

The Perwich ciphertexts in the `data/ciphertext` directory are derived from a [blog post](https://www.nationalarchives.gov.uk/explore-the-collection/the-collection-blog/undeciphered-letter-from-louis-xivs-france/) published by the National Archives. The source data is licensed under the [Open Government Licence v3.0](https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/). The texts were prepared from a combination of the body text and photographs in the blog post.
